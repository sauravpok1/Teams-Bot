// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.SupportV1ConditionMW = void 0;
const teamsfx_api_1 = require("@microsoft/teamsfx-api");
const error_1 = require("../error");
const tools_1 = require("../tools");
function SupportV1ConditionMW(supported) {
    return async (ctx, next) => {
        const inputs = ctx.arguments[ctx.arguments.length - 1];
        if (inputs.projectPath && (await tools_1.isMigrateFromV1Project(inputs.projectPath)) && !supported) {
            const func = ctx.arguments[0];
            if (ctx.method !== "executeUserTask" || (func === null || func === void 0 ? void 0 : func.namespace) === "fx-solution-azure") {
                ctx.result = teamsfx_api_1.err(error_1.V1ProjectNotSupportedError());
                return;
            }
        }
        await next();
    };
}
exports.SupportV1ConditionMW = SupportV1ConditionMW;
//# sourceMappingURL=supportV1ConditionHandler.js.map