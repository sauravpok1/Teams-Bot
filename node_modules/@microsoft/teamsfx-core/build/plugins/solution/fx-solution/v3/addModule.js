"use strict";
// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
Object.defineProperty(exports, "__esModule", { value: true });
exports.addModule = exports.getQuestionsForAddModule = void 0;
const teamsfx_api_1 = require("@microsoft/teamsfx-api");
const error_1 = require("./error");
const questions_1 = require("../../utils/questions");
async function getQuestionsForAddModule(ctx, inputs) {
    return teamsfx_api_1.ok(new teamsfx_api_1.QTreeNode(questions_1.selectCapabilitiesQuestion));
}
exports.getQuestionsForAddModule = getQuestionsForAddModule;
async function addModule(ctx, localSettings, inputs) {
    const solutionSettings = ctx.projectSetting.solutionSettings;
    const module = {
        capabilities: inputs.capabilities || [],
    };
    const capSet = new Set();
    solutionSettings.modules.forEach((m) => m.capabilities.forEach((c) => capSet.add(c)));
    for (const cap of inputs.capabilities || []) {
        if (capSet.has(cap)) {
            return teamsfx_api_1.err(new error_1.CapabilityAlreadyAddedError(cap));
        }
        else {
            capSet.add(cap);
        }
    }
    solutionSettings.capabilities = Array.from(capSet);
    solutionSettings.modules.push(module);
    //TODO
    //call localDebug plugin's scaffold API
    return teamsfx_api_1.ok(teamsfx_api_1.Void);
}
exports.addModule = addModule;
//# sourceMappingURL=addModule.js.map