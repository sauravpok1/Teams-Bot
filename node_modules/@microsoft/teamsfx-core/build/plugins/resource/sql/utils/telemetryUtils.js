"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TelemetryUtils = void 0;
const constants_1 = require("../constants");
class TelemetryUtils {
    static init(ctx) {
        TelemetryUtils.ctx = ctx;
    }
    static sendEvent(eventName, success, properties, measurements) {
        var _a;
        if (!properties) {
            properties = {};
        }
        if (success) {
            properties[constants_1.Telemetry.properties.success] = constants_1.Telemetry.valueYes;
        }
        this.addProperties(properties);
        (_a = TelemetryUtils.ctx.telemetryReporter) === null || _a === void 0 ? void 0 : _a.sendTelemetryEvent(eventName, properties, measurements);
    }
    static sendErrorEvent(eventName, errorCode, errorType, errorMessage, properties, measurements) {
        var _a;
        if (!properties) {
            properties = {};
        }
        properties[constants_1.Telemetry.properties.success] = constants_1.Telemetry.valueNo;
        properties[constants_1.Telemetry.properties.errorCode] = errorCode;
        properties[constants_1.Telemetry.properties.errorType] = errorType;
        properties[constants_1.Telemetry.properties.errorMessage] = errorMessage;
        this.addProperties(properties);
        (_a = TelemetryUtils.ctx.telemetryReporter) === null || _a === void 0 ? void 0 : _a.sendTelemetryErrorEvent(eventName, properties, measurements);
    }
    static addProperties(properties) {
        var _a;
        properties[constants_1.Telemetry.properties.component] = constants_1.Telemetry.componentName;
        const appId = (_a = this.ctx.envInfo.state
            .get(constants_1.Constants.solution)) === null || _a === void 0 ? void 0 : _a.get(constants_1.Constants.solutionConfigKey.remoteTeamsAppId);
        if (appId) {
            properties[constants_1.Telemetry.properties.appid] = appId;
        }
        else {
            properties[constants_1.Telemetry.properties.appid] = "";
        }
    }
}
exports.TelemetryUtils = TelemetryUtils;
//# sourceMappingURL=telemetryUtils.js.map